<app-candidateheader #head (setting)="get_setting($event)" (wallet)="get_wallet($event)" [resetHeaderBasket]="resetBasket" ></app-candidateheader>

<!-- Sub Header -->
<app-breadcrumbs side="front" [form_title]="form_title" [current_url_array]="current_url_array" ></app-breadcrumbs>
<!-- Sub Header End -->

<div class="regbg padding-all page-min-height maxf-width"> 
    <div class="regpage"> 
		<div class="regform mt-3">
					
			<ngb-alert *ngIf="!closed" class="animate-show animate-hide " type="{{alertClass}}" (close)="closed = true"><strong innerHTML={{alertMessage}} >{{ alertMessage }}</strong></ngb-alert>
					 
			<form [formGroup] = "formdata" > 
				<div class="row pt-4"> 
					<div class="col-lg-3 col-md-6 mb-3 text-center"> 	
						<div class="profile_bg"> 
							<div class="row"> 
								<div class="col-md-12 mb-2 ">										
									<div class="pimg_relative">	
										<img *ngIf="croppedImage!=''" class="crop-image" [src]="croppedImage" />
										<img *ngIf="croppedImage==''" class="crop-image" src="{{server_url}}media/profile/profile-img.jpg">
										
										<div class="pimg_absolute">
											<a href="javascript:void(0);" (click)="openmodal()" class="">		
												<fa-icon [icon]="faCamera" class="iconcmr"></fa-icon>
											</a>
										</div>											
									</div>
								</div>								
								<div class="col-md-12">
									<a href="javascript:void(0);" (click)="openmodal()" class="upload_profile">Upload Profile</a>
								</div>
								
								<div *ngIf="last_login_date!=''" class="col-md-12">
									<p class="upload_profile">Last Login: {{last_login_date}}</p>
								</div>

								<div *ngIf="credit_system=='Active'" class="col-md-12">
									<p class="upload_profile" placement="top" ngbTooltip="View & Generate TPIN" ><a (click)="viewTPin(tpinpopup)" >Transaction PIN</a></p>
								</div>
	

							</div>
						</div>							
					</div>					
					
					<div class="col-lg-9 col-md-12"> 
						<div class="row">
							<div class="col-lg-6 col-md-6 min-width-col6"> 
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										 <label for="f_name">First Name:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										 <input type = "text" class = "form-control fortextbox" id="f_name" name = "f_name" placeholder = "First Name" formControlName="f_name" >  
										<ng-container *ngFor="let error of error_messages.f_name">
											<div class="error-message" *ngIf="formdata.get('f_name').hasError(error.type) && (formdata.get('f_name').dirty || formdata.get('f_name').touched)">
												{{ error.message }}
											</div>
										</ng-container>									
									</div>
								</div>
						
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>Middle Name:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<input type = "text" class = "form-control fortextbox" name = "m_name" placeholder = "Middle Name" formControlName="m_name"  >                           
									</div>
								</div>
							
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>Last Name:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<input type = "text" class = "form-control fortextbox" name = "l_name" placeholder = "Last Name"  formControlName="l_name"    >   
										<ng-container *ngFor="let error of error_messages.l_name">
											<div class="error-message" *ngIf="formdata.get('l_name').hasError(error.type) && (formdata.get('l_name').dirty || formdata.get('l_name').touched)">
												{{ error.message }}
											</div>
										</ng-container>															
									</div>
								</div>
							 
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>Email:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<input type = "email" class = "form-control fortextbox" name = "email" readonly placeholder = "Email" formControlName="email"  >
										<ng-container *ngFor="let error of error_messages.email">
											<div class="error-message" *ngIf="formdata.get('email').hasError(error.type) && (formdata.get('email').dirty || formdata.get('email').touched)">
												{{ error.message }}
											</div>
										</ng-container>															
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>Mobile:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<input type = "text" class = "form-control fortextbox" name = "mobile" placeholder = "Mobile" formControlName="mobile" >
										<ng-container *ngFor="let error of error_messages.mobile">
											<div class="error-message" *ngIf="formdata.get('mobile').hasError(error.type) && (formdata.get('mobile').dirty || formdata.get('mobile').touched)">
												{{ error.message }}
											</div>
										</ng-container>															
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>Language:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<select class="form-control fortextbox" name = "language" formControlName="language" >
											<option value="null">Select Language</option>
											<option value="1">Hindi</option>
											<option value="2">English</option>
										</select>
										<ng-container *ngFor="let error of error_messages.language">
											<div class="error-message" *ngIf="formdata.get('language').hasError(error.type) && (formdata.get('language').dirty || formdata.get('language').touched)">
												{{ error.message }}
											</div>
										</ng-container>														
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										 <label>Address:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<textarea class = "form-control fortextbox" name = "address" rows="1" placeholder = "Address" formControlName="address" ></textarea>
										<ng-container *ngFor="let error of error_messages.address">
											<div class="error-message" *ngIf="formdata.get('address').hasError(error.type) && (formdata.get('address').dirty || formdata.get('address').touched)">
												{{ error.message }}
											</div>
										</ng-container>															
									</div>
								</div>
							</div>										
								
							<div class="col-lg-6 col-md-6 min-width-col6"> 
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>Country:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<select class="form-control fortextbox" name = "country" (change) = "changeCountry($event)"  formControlName="country" >
											<option  value="null">Select Country</option>
											<option *ngFor="let country of countryList; let i = index" [value]="countryList[i].id">
												{{country.country_name}}
											</option>
										</select>	
										<ng-container *ngFor="let error of error_messages.country">
											<div class="error-message" *ngIf="formdata.get('country').hasError(error.type) && (formdata.get('country').dirty || formdata.get('country').touched)">
												{{ error.message }}
											</div>
										</ng-container>															
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>State:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<select class="form-control fortextbox" name = "state" formControlName="state" >
											<option value="null">Select State</option>
											<option *ngFor="let state of stateList; let i = index" [value]="stateList[i].id">
												{{state.state_name}}
											</option>
										</select>
										<ng-container *ngFor="let error of error_messages.state">
											<div class="error-message" *ngIf="formdata.get('state').hasError(error.type) && (formdata.get('state').dirty || formdata.get('state').touched)">
												{{ error.message }}
											</div>
										</ng-container>															
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>City:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<input type = "text" class = "form-control fortextbox" name = "city" placeholder = "City" formControlName="city" >
										<ng-container *ngFor="let error of error_messages.city">
											<div class="error-message" *ngIf="formdata.get('city').hasError(error.type) && (formdata.get('city').dirty || formdata.get('city').touched)">
												{{ error.message }}
											</div>
										</ng-container>															
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>Pin:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<input type = "text" class = "form-control fortextbox" name = "pin" placeholder = "Pin" formControlName="pin" >
										<ng-container *ngFor="let error of error_messages.pin">
											<div class="error-message" *ngIf="formdata.get('pin').hasError(error.type) && (formdata.get('pin').dirty || formdata.get('pin').touched)">
												{{ error.message }}
											</div>
										</ng-container>														
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>Gender:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<select class="form-control fortextbox" name = "sex" formControlName="sex"  >
											<option value="null">Select Gender</option>
											<option value="1" >Male</option>
											<option value="2" >Female</option>
										</select>
										<ng-container *ngFor="let error of error_messages.sex">
											<div class="error-message" *ngIf="formdata.get('sex').hasError(error.type) && (formdata.get('sex').dirty || formdata.get('sex').touched)">
												{{ error.message }}
											</div>
										</ng-container>															
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">
										<label>New Password:</label>
									</div>
									<div class="col-md-8 col_input form-group" >
										<input type = "password" class = "form-control fortextbox" name = "password" placeholder = "Password" formControlName="password" >
										<ng-container *ngFor="let error of error_messages.password">
											<div class="error-message" *ngIf="formdata.get('password').hasError(error.type) && (formdata.get('password').dirty || formdata.get('password').touched)">
												{{ error.message }}
											</div>
										</ng-container>															
									</div>
								</div>
								
								<div class="row d-none d-xl-block d-lg-block d-sm-block d-md-block">
									<div class="col-md-4 col_lable form_lable form-group">	
										<br>
									</div>
									<div class="col-md-8 col_input btn_align">
										<br>						
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-4 col_lable form_lable form-group">												
									</div>
									<div class="col-md-8 col_input btn_align  mb-3">
										<div class="btn-box">
											<div class="theme-btn">
												<span class="txt">									
													<button class="forsubmit btn_blueas" (click)="onSubmit(formdata.value)">Update Profile</button>
												</span>
											</div>
										</div>							
									</div>
								</div>
							</div>									
						</div>							
					</div>	
				</div>
			</form>                  
		</div>
	</div>
</div>

<div class="modal {{modalfadeclass}} {{modalshow}} dk-model-box" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header dk-model-header">
				<h5 class="modal-title" id="exampleModalLabel">Upload Profile Photo</h5>
				<button type="button" (click)="closemodal()" class="close mclose" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>

			<div *ngIf="croppedImage!=''" class="col-md-12 mt-3 text-center float-left">
				<img class="crop-image" [src]="croppedImage" />  
				<p class="previewimg">Preview</p>
			</div>


			<div class="modal-body">
				<image-cropper
					[imageChangedEvent]="imageChangedEvent"
					[maintainAspectRatio]="true"
					[containWithinAspectRatio]="containWithinAspectRatio"
					[aspectRatio]="1/1"
					[resizeToWidth]="100"
					[resizeToHeight]="100"
					[cropperMinWidth]="100"
					[cropperMinHeight]="100"
					[cropperStaticWidth]="100"
					[cropperStaticHeight]="100"
					[onlyScaleDown]="true"
					[roundCropper]="true"
					[initialStepSize] ="3"
					[canvasRotation]="canvasRotation"
					[transform]="transform"
					[style.display]="showCropper ? null : 'none'"
					format="png"
					(imageCropped)="imageCropped($event)"
					(imageLoaded)="imageLoaded()"
					(cropperReady)="cropperReady($event)"
					(loadImageFailed)="loadImageFailed()"
				></image-cropper>
				<div class="col-md-12 mt-3 mb-2 float-left">	
					<div class="mautobtn">	
						<div class="floatleft">
							<input name="profile_photo" class="choosimg" type="file" (change)="fileChangeEvent($event)" />
						</div>
						<div class="btn-box text-center">
							<div class="theme-btn">
								<span class="txt">												
									<button class="btn btn-sm btn_blueas" (click)="zoomOut()">Zoom -</button>
								</span>
							</div>
						</div>
						
						<div class="btn-box text-center">
							<div class="theme-btn">
								<span class="txt">												
									<button class="btn btn-sm btn_blueas" (click)="zoomIn()">Zoom +</button>
								</span>
							</div>
						</div>
					</div>
				</div>                              
			</div>
		</div>
	</div>
</div>


<ng-template #tpinpopup let-modal >
	<div class="dk-model-box">
		<div class="modal-header dk-model-header">
			<h4 class="modal-title" id="modal-basic-title">Transaction PIN</h4>
			<button type="button" class="close mclose" aria-label="Close" (click)="modal.dismiss('Cross click')">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
		
		<div class="mtable-height">
			<div class="modal-body">
				<div class="col-lg-12 col-md-12 col-12 p-0 float-left mt-2 mb-3 text-center">
					<b>{{t_pin}}</b>
				</div> 
				<div class="clearfix"></div>
				<div class="col-md-12 float-left text-center pb-3">
					<div class="btn-box text-center">
						<div class="theme-btn">
							<span class="txt">												
								<button type="button" (click)="GeneratePin()" class="btn btn_blueas tpin">Generate</button>
							</span>
						</div>
					</div>
				</div>	
			</div>
		</div>
	</div>
</ng-template>

<div *ngIf="progressbar" class="progressbar-area col-md-12"> 
	<div class="inner-area col-md-6 text-center">
		<img src="{{server_url}}media/images/loader.svg" class="img-fluid">
		<p class="text-center loaderc" >Please Wait ...</p>
    </div>
</div>
<app-candidatefooter></app-candidatefooter>     